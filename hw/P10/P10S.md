# Lecture 10 Problems - Solutions

1.  
    ```python
    Minv = np.linalg.inv(M)
    for y in range(DH):
        for x in range(DW):
            xh, yh, wh = Minv @ [x, y, 1]
            xsrc = round(xh/wh)
            ysrc = round(yh/wh)
            if (0 <= xsrc < W) and (0 <= ysrc < H):
                out[y, x] = img[ysrc, xsrc]
    ```

2.  
    $$(T_{23} T_{12})^{-1}$$
    or
    $$T_{12}^{-1}T_{23}^{-1}$$

3. Transform and normalize each of the four corners using T:

$$
\begin{align}
\begin{bmatrix} 
x_h \\ 
y_h \\ 
w_h 
\end{bmatrix}
&= T \begin{bmatrix}
c_x \\ 
c_y \\ 
1 
\end{bmatrix}\\
\begin{bmatrix}
c_x'\\
c_y' 
\end{bmatrix}
&= \begin{bmatrix}
x_h/w_h \\
y_h/w_h 
\end{bmatrix}\\
\end{align}
$$
   
for each corner $c_x, c_y$ in $(0, 0), (0, w), (h, 0), (h, w)$.

Then,
   
$$
\begin{align}
box_{xmin} &= \min(\mbox{all } c_x)\\
box_{xmax} &= \max(\mbox{all } c_x)\\
box_{ymin} &= \min(\mbox{all } c_y)\\
box_{ymax} &= \max(\mbox{all } c_y)\\
\end{align}
$$

5. Let $u = (y_i - \hat{y}_i) = (y_i - (wx_i + b))$.

   * $w$ derivative:

     * $\frac{\partial \mathcal{L}}{\partial u} = \frac{\partial }{\partial u} \left[ \frac{1}{n}\sum_{i=1}^{n} u^2\right]$

       We can pull the differentiation inside the sum and get $\frac{1}{n}\sum_{i=1}^n 2u$

     * $\frac{\partial u}{\partial w}  = \frac{\partial}{\partial w} (y_i - (wx_i + b))$
       The coefficient on $w$ is $-x_i$.

     * Put together, the result we want is the product of these:
       $$
       \begin{align*}
       \frac{\partial \mathcal{L}}{\partial w}
       &= \frac{\partial L}{\partial u} \frac{\partial u}{\partial w} \\
       &= \frac{1}{n}\sum_{i=1}^n 2(y_i - \hat{y_i})(-x_i) \\
       &= -\frac{2}{n}\sum_{i=1}^n x_i(y_i - \hat{y_i})
       \end{align*}
       $$
       

   * $b$ derivative is similar to the above:

     * $\frac{\partial \mathcal{L}}{\partial u} = \frac{\partial }{\partial u} \left[ \frac{1}{n}\sum_{i=1}^{n} u^2\right] = \frac{1}{n}\sum_{i=1}^n 2u$
     * $\frac{\partial u}{\partial b}  = \frac{\partial}{\partial b} (y_i - (wx_i + b))$
       The coefficient on $b$ is $-1$.
     * Put together, the result we want is the product of these: $\frac{\partial \mathcal{L}}{\partial w} = \frac{\partial L}{\partial u} \frac{\partial u}{\partial b} = -\frac{2}{n}\sum_{i=1}^n (y_i - \hat{y_i})$
